---
hide.anonymous: FALSE
title: |
  | Human Trafficking Survey Results Report
  | • • •
  | Anonymous organizations unredacted
  | US-only organizations removed
  | • • •
author: "Judith Kelley"
date: "`r format(Sys.time(), '%B %e, %Y')`"
mainfont: DejaVu Sans
fontsize: 10pt
output:
  pdf_document:
    includes:
      in_header: ../TeX/top_stuff.tex
    latex_engine: xelatex
    toc: yes
    toc_depth: 1
---

```{r setup, echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE}
# Set the working directory one level back
library(knitr)
opts_knit$set(root.dir = normalizePath('../'))
opts_chunk$set(cache=FALSE)

library(pander)
panderOptions('table.split.table', Inf)
# panderOptions('knitr.auto.asis', FALSE)  # Someday

# Process and clean all the data
source("../R/clean_data.R", chdir=TRUE)

# Load plotting helper functions
source("../R/summary_functions.R", chdir=TRUE)

# MAYBE: Find a font that covers Khmer too (not even Arial Unicode MS does, apparently)
# TODO: Embed fonts in plots
# MAYBE: Multicolumnn table instead of list?
# TODO: Response rate
# TODO: Ignore organizations marked for removal
# TODO: Figure out correct denominator for response rate
#   Infer that half of the US-based organizations that didn't respond work solely in the US, since 40 of the 78 didn't
# TODO: Figure out correct denominator for multiple answer responses
#   Multiple answers, make column looking for if all the possible answers are blank - if so, ignore from denominators - since we forgot "none of the above" or "don't know"
# TODO: Include row for number of unique countries
# TODO: Percent column using decimal funnily
# TODO: Explain conditional questions
# TODO: Data dictionary for labels (http://stackoverflow.com/questions/2151147/using-stata-variable-labels-in-r)

```


# Q1.2: What is the name of your organization?

```{r, echo=FALSE, results='asis', cache=FALSE}
if (rmarkdown::metadata$hide.anonymous == TRUE) {
  org.names <- responses.org.foreign %>% filter(Q1.3 == "No") %>% select(name = Q1.2)
  pandoc.p("*Organizations requesting anonymity have been omitted.*")
} else {
  org.names <- responses.org.foreign %>% select(name = Q1.2)
}
pandoc.list(clean.text(org.names$name))
```


# Q1.3: Would you like your organization to remain anonymous in this study's reports?

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
plot.single.question(responses.org.foreign$Q1.3)
```

```{r, echo=FALSE, results='asis'}
pandoc.table(factor.summary(responses.org.foreign$Q1.3))
```


# Q1.4: Where is your organization's main office?

*For better visual contrast, the number of NGOs shown on the map has been capped at 10. Actual country frequencies can be seen in the table that follows.*

```{r, echo=FALSE, warning=FALSE, fig.width=7.5}
ggplot(home.countries.plot, aes(map_id=id)) +
  geom_map(aes(fill=freq_ceiling), map=world.ggmap, colour="black", size=0.25) +
  expand_limits(x=world.ggmap$long, y=world.ggmap$lat) +
  scale_fill_gradient(high="#ff7f00", low="#fff7bc", na.value="grey",
                      guide="colorbar", name="# of NGOs") +
  coord_map(xlim=c(-180,180), ylim=c(-60, 90)) +
  theme_blank_map + theme(legend.key.width=unit(0.55, "line"))
```

```{r, echo=FALSE, results='asis'}
pandoc.table(factor.summary(responses.org.foreign$home.country, sort.me=TRUE))
```


# Q1.5: In how many countries has your organization done most of its advocacy work over the past 10 years?

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
plot.single.question(responses.org.foreign$Q1.5.factor)
```

```{r, echo=FALSE, results='asis'}
pandoc.table(factor.summary(responses.org.foreign$Q1.5.factor))
```


# Q2.1: About what percent of your organization's time and resources are spent on fighting against trafficking or helping victims of trafficking?

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
ggplot(responses.org.foreign, aes(x=Q2.1/100, y=(..count.. / sum(..count..)))) + 
  geom_histogram(binwidth=.1, fill=bar.color.single) + 
  labs(x="Proportion of time", y="Proportion of responses") + 
  scale_x_continuous(labels=percent, limits=c(0, 1), breaks=seq(0, 1, 0.2)) +
  scale_y_continuous(labels=percent) + 
  theme_bar
```

```{r, echo=FALSE, results='asis'}
pandoc.table(numeric.summary(responses.org.foreign$Q2.1))
```


# Q2.2: Which human trafficking issues is your organization most involved with?

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
cols <- c("Q2.2_1", "Q2.2_2", "Q2.2_3", "Q2.2_4")
labels <- c("Organ trafficking", "Sex trafficking", 
            "Labor trafficking", "Other")

plot.multiple.answers(responses.org.foreign, cols, labels)
```

```{r, echo=FALSE, results='asis'}
pandoc.table(separate.answers.summary(responses.org.foreign, cols, 
                                      labels, n=num.responses, total=TRUE))
```

## Other responses

```{r, echo=FALSE, results='asis'}
pandoc.list(clean.text(responses.org.foreign$Q2.2_4_TEXT))
```


# Q2.3: Which kinds of victims is your organization most involved with?

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
cols <- c("Q2.3_1", "Q2.3_2", "Q2.3_3")
labels <- c("Children", "Adults", "Other")

plot.multiple.answers(responses.org.foreign, cols, labels)
```

```{r, echo=FALSE, results='asis'}
pandoc.table(separate.answers.summary(responses.org.foreign, cols, 
                                      labels, n=num.responses, total=TRUE))
```

## Other responses

```{r, echo=FALSE, results='asis'}
pandoc.list(clean.text(responses.org.foreign$Q2.3_3_TEXT))
```


# Q2.4: Which efforts does your organization focus on most?

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
cols <- c("Q2.4_1", "Q2.4_2", "Q2.4_3", "Q2.4_4", "Q2.4_5")
labels <- c("Prevention and education", "Prosecutions and legal issues",
            "Victim protection", "Victim assistance", "Other")

plot.multiple.answers(responses.org.foreign, cols, labels)
```

```{r, echo=FALSE, results='asis'}
pandoc.table(separate.answers.summary(responses.org.foreign, cols, 
                                      labels, n=num.responses, total=TRUE))
```

## Other responses

```{r, echo=FALSE, results='asis'}
pandoc.list(clean.text(responses.org.foreign$Q2.4_5_TEXT))
```


# Q2.5: The US State Department issues an annual Trafficking in Persons (TIP) report. Have you ever heard of this annual report?

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
plot.single.question(responses.org.foreign$Q2.5)
```

```{r, echo=FALSE, results='asis'}
pandoc.table(factor.summary(responses.org.foreign$Q2.5))
```


# Q2.6: In Fall 2013 an NGO named WalkFree published a "Human Trafficking Index" that rated countries on how many trafficking victims they have. Have you heard of this index?

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
plot.single.question(responses.org.foreign$Q2.6)
```

```{r, echo=FALSE, results='asis'}
pandoc.table(factor.summary(responses.org.foreign$Q2.6))
```



# Q3.2: Where has your organization done advocacy work?

*For better visual contrast, the number of NGOs shown on the map has been capped at 10. Actual country frequencies can be seen in the table that follows.*

```{r, echo=FALSE, warning=FALSE, fig.width=7.5}
ggplot(work.countries.plot, aes(map_id=id)) +
  geom_map(aes(fill=freq_ceiling), map=world.ggmap, colour="black", size=0.25) +
  expand_limits(x=world.ggmap$long, y=world.ggmap$lat) +
  scale_fill_gradient(high="#ff7f00", low="#fff7bc", na.value="grey",
                      guide="colorbar", name="# of NGOs") +
  coord_map(xlim=c(-180,180), ylim=c(-60, 90)) +
  theme_blank_map + theme(legend.key.width=unit(0.55, "line"))
```

```{r, echo=FALSE, results='asis'}
pandoc.table(factor.summary(responses.countries$work.country, sort.me=TRUE))
```


# Q3.2a: Countries that have no reported advocacy work

```{r, echo=FALSE, results='asis'}
countries.left <- work.countries.plot %>% 
  filter(is.na(freq), id != "USA") %>%
  arrange(country) %>% select(country)

pandoc.list(countries.left$country)
```


# Q3.3: How much does your organization know about human trafficking policy in X?

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
plot.single.question(responses.countries$Q3.3)
```

```{r, echo=FALSE, results='asis'}
pandoc.table(factor.summary(responses.countries$Q3.3))
```


# Q3.4: How often does your organization work directly with the government of X?

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
plot.single.question(responses.countries$Q3.4)
```

```{r, echo=FALSE, results='asis'}
pandoc.table(factor.summary(responses.countries$Q3.4))
```


# Q3.5: In X, which of these institutions have been active in fighting human trafficking over the last 10–15 years?

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
cols <- c("Q3.5_1", "Q3.5_2", "Q3.5_3", "Q3.5_4", "Q3.5_5")
labels <- c("The national government", "NGOs and civil society",
            "Embassies or foreign governments", "International organizations", "Other")

plot.multiple.answers(responses.countries, cols, labels)
```

```{r, echo=FALSE, results='asis'}
pandoc.table(separate.answers.summary(responses.countries, cols, 
                                      labels, n=num.country.responses, total=TRUE))
```

## Other responses

```{r, echo=FALSE, results='asis'}
pandoc.list(clean.text(responses.countries$Q3.5_5_TEXT))
```


# Q3.6: Which embassies or foreign governments have been active in fighting human trafficking in X?

```{r, echo=FALSE, results='asis'}
pandoc.list(clean.text(responses.countries$Q3.6))
```


# Q3.7: Which of these embassies or foreign governments have been the most active?

```{r, echo=FALSE, results='asis'}
pandoc.list(clean.text(responses.countries$Q3.7))
```


# Q3.8: Over the last 10–15 years, has the United States or its embassy been active in the fight against human trafficking in X?

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
plot.single.question(responses.countries$Q3.8)
```

```{r, echo=FALSE, results='asis'}
pandoc.table(factor.summary(responses.countries$Q3.8))
```


# Q3.9: Has the United States or its embassy been involved in any of the following activities in X?

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
cols <- c("Q3.9_1", "Q3.9_2", "Q3.9_3", "Q3.9_4", "Q3.9_5",
          "Q3.9_6", "Q3.9_7", "Q3.9_8", "Q3.9_9", "Q3.9_10")
labels <- c("Asking for legislation", "Convening conferences or workshops",
            "Raising awareness", "Providing resources or funding",
            "Increasing government attention", "Training government officials",
            "Contributing to a government action plan", "Other", "Don't know",
            "The US has not been involved in trafficking issues")

plot.multiple.answers(responses.countries, cols, labels)
```

```{r, echo=FALSE, results='asis'}
pandoc.table(separate.answers.summary(responses.countries, cols, 
                                      labels, n=num.country.responses, total=TRUE))
```


# Q3.10: Please explain how the United States asked the government to pass or amend anti-trafficking laws in X:

```{r, echo=FALSE, results='asis'}
pandoc.list(clean.text(responses.countries$Q3.10))
```


# Q3.11: Please explain how the United States convened conferences or workshops on trafficking in X:

```{r, echo=FALSE, results='asis'}
pandoc.list(clean.text(responses.countries$Q3.11))
```


# Q3.12: Please explain how the United States raised awareness about trafficking in X:

```{r, echo=FALSE, results='asis'}
pandoc.list(clean.text(responses.countries$Q3.12))
```


# Q3.13: Please explain how the United States provided resources or funding for anti-trafficking programs in X:

```{r, echo=FALSE, results='asis'}
pandoc.list(clean.text(responses.countries$Q3.13))
```


# Q3.14: Please explain how the United States increased government attention to trafficking in X:

```{r, echo=FALSE, results='asis'}
pandoc.list(clean.text(responses.countries$Q3.14))
```


# Q3.15: Please explain how the United States increased government attention to trafficking in X:

```{r, echo=FALSE, results='asis'}
pandoc.list(clean.text(responses.countries$Q3.15))
```


# Q3.16: Please explain how the United States contributed to a government action plan in X:

```{r, echo=FALSE, results='asis'}
pandoc.list(clean.text(responses.countries$Q3.16))
```


# Q3.17: Please explain how else the US government has been involved in trafficking issues in X:

```{r, echo=FALSE, results='asis'}
pandoc.list(clean.text(responses.countries$Q3.17))
```


# Q3.18: Over the last 10–15 years, has your organization worked directly with or had direct contact with the US embassy or government on human trafficking issues?

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
cols <- c("Q3.18_1", "Q3.18_2", "Q3.18_3", "Q3.18_4", "Q3.18_5", "Q3.18_6")
labels <- c("Direct contact (meetings)", "Direct cooperation", 
            "Our organization received funding", "Other", 
            "We have not had any contact or funding from the US", "Don't know")

plot.multiple.answers(responses.countries, cols, labels)
```

```{r, echo=FALSE, results='asis'}
pandoc.table(separate.answers.summary(responses.countries, cols, 
                                      labels, n=num.country.responses, total=TRUE))
```

## Other responses

```{r, echo=FALSE, results='asis'}
pandoc.list(clean.text(responses.countries$Q3.18_4_TEXT))
```


# Q3.19: Overall, how important a role would you say that the United States or its embassy have played in fighting trafficking in X over the last 10–15 years?

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
plot.single.question(responses.countries$Q3.19)
```

```{r, echo=FALSE, results='asis'}
pandoc.table(factor.summary(responses.countries$Q3.19))
```


# Q3.20: In your view, how hard is the government of X working to combat trafficking in persons?

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
plot.single.question(responses.countries$Q3.20)
```

```{r, echo=FALSE, results='asis'}
pandoc.table(factor.summary(responses.countries$Q3.20))
```


# Q3.21: Has your organization used the US State Department's Trafficking in Persons (TIP) report to discuss trafficking issues with any of these groups?

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
cols <- c("Q3.21_1", "Q3.21_2", "Q3.21_3", "Q3.21_4")
labels <- c("Government of X", "Another government", "Other NGOs", "Other")

plot.multiple.answers(responses.countries, cols, labels)
```

```{r, echo=FALSE, results='asis'}
pandoc.table(separate.answers.summary(responses.countries, cols, 
                                      labels, n=num.country.responses, total=TRUE))
```

## Other responses

```{r, echo=FALSE, results='asis'}
pandoc.list(clean.text(responses.countries$Q3.21_4_TEXT))
```


# Q3.22: Which TIP tier rating did X receive this year?

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
plot.single.question(responses.countries$Q3.22)
```

```{r, echo=FALSE, results='asis'}
pandoc.table(factor.summary(responses.countries$Q3.22))
```


# Q3.23: Have you ever heard—in public or private—officials in X mention the TIP tier rating?

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
plot.single.question(responses.countries$Q3.23)
```

```{r, echo=FALSE, results='asis'}
pandoc.table(factor.summary(responses.countries$Q3.23))
```


# Q3.24: What was their reason for mentioning it?

```{r, echo=FALSE, results='asis'}
pandoc.list(clean.text(responses.countries$Q3.24))
```


# Q3.25: Overall, has the US influence on human trafficking policy in X been positive or negative?

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
plot.single.question(responses.countries$Q3.25)
```

```{r, echo=FALSE, results='asis'}
pandoc.table(factor.summary(responses.countries$Q3.25))
```


# Q3.26: Would you say that the government of X's efforts to combat trafficking over the past 10–15 years have:

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
plot.single.question(responses.countries$Q3.26)
```

```{r, echo=FALSE, results='asis'}
pandoc.table(factor.summary(responses.countries$Q3.26))
```


# Q3.27: Does a member of the government or ruling party of X sit on your board?

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
plot.single.question(responses.countries$Q3.27)
```

```{r, echo=FALSE, results='asis'}
pandoc.table(factor.summary(responses.countries$Q3.27))
```


# Q3.28: Is your organization required by law to have a member of the government or ruling party sit on your board?

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
plot.single.question(responses.countries$Q3.28)
```

```{r, echo=FALSE, results='asis'}
pandoc.table(factor.summary(responses.countries$Q3.28))
```


# Q3.29: How much is your organization's work restricted by government regulations in X?

```{r, warning=FALSE, echo=FALSE, fig.width=6.5, fig.height=3}
plot.single.question(responses.countries$Q3.29)
```

```{r, echo=FALSE, results='asis'}
pandoc.table(factor.summary(responses.countries$Q3.29))
```


# Q3.30: How is your organization's work restricted by government regulations in X?

```{r, echo=FALSE, results='asis'}
pandoc.list(clean.text(responses.countries$Q3.30))
```


# Q4.1: Do you have any additional comments?

```{r, echo=FALSE, results='asis'}
pandoc.list(clean.text(responses.org.foreign$Q4.1))
```
